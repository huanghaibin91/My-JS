<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>storage</title>
    </head>
    <body>
        <script type="text/javascript">
            // 浏览器网络状态
            if (navigator.onLine) {
                // 正常工作
            } else {
                // 执行离线状态时的任务
            }
            // online, offline事件，在网络状态改变时触发，这两个事件在window对象上触发

            // Cookie，HTTP cookie

            // cookie选项包括：expires、domain、path、secure、HttpOnly。在设置任一个cookie时都可以设置相关的这些属性，
            // 当然也可以不设置，这时会使用这些属性的默认值。在设置这些属性时，属性之间由一个分号和一个空格隔开
            // expires选项用来设置“cookie 什么时间内有效”。expires其实是cookie失效日期，expires必须是 GMT 格式的时间（可以通过 
            // new Date().toGMTString()或者 new Date().toUTCString() 来获得）
            // domain是域名，path是路径，两者加起来就构成了 URL，domain和path一起来限制 cookie 能被哪些 URL 访问
            // secure选项用来设置cookie只在确保安全的请求中才会发送。当请求是HTTPS或者其他安全协议时，包含 secure 选项的 cookie 才能被发送至服务器
            // 当cookie带httpOnly选项时，客户端则无法通过js代码去访问（包括读取、修改、删除等）这个cookie
            
            // cookie是绑定在特定的域名下的，而且有限制，大小是4096B以下
            // cookie的构成：名称，一个唯一确定cookie的名称，不区分大小写。值，储存在cookie中的字符串值。
            // 值必须被URL编码。域，cookie对于哪个域是有效的，所有向该域发送的请求中都会包含这个cookie信息。
            // 路径，对于指定域中的那个路径，应该向服务器发送cookie。失效时间expires，表示cookie何时应该被删除的时间戳。
            // 安全标志，指定后，cookie只有在使用SSL连接的时候才发送到服务器。以上，cookie的名字和值是必须的。

            // 获取cookie： document.cookie

            // cookie操作
            var CookieUtil = {
                get: function (name) {
                    var cookieName = encodeURIComponent(name) + '=',
                        cookieStart = document.cookie.indexOf(cookieName),
                        cookieValue = null;
                    if (cookieStart > -1) {
                        var cookieEnd = document.cookie.indexOf(';', cookieStart);
                        if (cookieEnd == -1) {
                            cookieEnd = document.cookie.length;
                        }
                        cookieValue = decodeURIComponent(document.cookie.substring(cookieStart + cookieName.length, cookieEnd));
                    }
                    return cookieValue;
                },
                set: function (name, value, expires, path, domain, secure) {
                    var cookieText = encodeURIComponent(name) + '=' + encodeURIComponent(value);
                    if (expires instanceof Date) {
                        cookieText += '; expires=' + expires.toGMTString();
                    }
                    if (path) {
                        cookieText += '; path=' + path;
                    }
                    if (domain) {
                        cookieText += '; domain=' + domain;
                    }
                    if (secure) {
                        cookieText += '; secure';
                    }
                },
                unset: function (name, path, domain, secure) {
                    this.set(name, '', new Date(0), path, domain, secure);
                }
            }

            // Storage，提供最大的存储空间来存储名值对，拥有以下方法，IE8+
            // clear()，删除所有值，Firefox未实现
            // getItem(name)，根据name获取值
            // key(index)，获取index处的值的名字
            // removeItem(name)，删除name指定的名值对
            // setItem(name, value)，为指定的name设置一个对应的值
            // length，名值对长度

            // sessionStorage，用于存储特定于某个会话的数据，也就是数据只保存到浏览器关闭，在浏览器关闭后消失。
            // 储存在sessionStorage中的数据可以跨越页面刷新而存在
            // sessionStorage是Storage的一个实例，所以可以用Storage的方法
            // sessionStorage.setItem('name', 'Tom') // 使用方法存储数据

            // IE不支持
            // globalStorage,目的是跨越会话存储数据，但有特定的访问限制，使用globalStorage的时候一定要指定一个域名，
            // 也可以使用Storage对象的方法，遵循同源策略
            // globalStorage['example.com'].name = 'Tom' // 只有example.com域可以访问
            // globalStorage[''].name = 'Tom' // 所有域都可以访问
            // globalStorage[local.host].name = 'Tom' // 不确定类名就使用local.host作为属性比较安全

            // IE8+
            // localStorage，持久保存客户端数据，要访问同一个localStorage对象，页面必须来自同一个域名（子域名无效），
            // 使用同一种协议，在同一个端口上
            // localStorage取代了globalStorage，localStorage是storage实例，可以使用storage的方法

            // storage事件，在对Storage对象进行修改后触发，有以下属性：
            // domain，发生变化的存储空间的域名
            // key，设置或删除的键名
            // newValue，如果是设置值，则是新值，如果删除值，则是null
            // oldValue，键被更改之前的值
            
        </script>
    </body>
</html>
